<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Method 3: pairwise tests | Mixed Effect Models</title>
  <meta name="description" content="9 Method 3: pairwise tests | Mixed Effect Models" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Method 3: pairwise tests | Mixed Effect Models" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Method 3: pairwise tests | Mixed Effect Models" />
  
  
  

<meta name="author" content="Compiled by Anna Ivanova based on materials by Idan Blank, Rachel Ryskin, and Cory Shain" />


<meta name="date" content="2020-12-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="method-2-model-comparison-1.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> INTRODUCTION</a></li>
<li class="chapter" data-level="2" data-path="meet-the-data.html"><a href="meet-the-data.html"><i class="fa fa-check"></i><b>2</b> Meet the Data</a><ul>
<li class="chapter" data-level="2.1" data-path="meet-the-data.html"><a href="meet-the-data.html#setting-up-the-environment"><i class="fa fa-check"></i><b>2.1</b> Setting up the environment</a></li>
<li class="chapter" data-level="2.2" data-path="meet-the-data.html"><a href="meet-the-data.html#the-data"><i class="fa fa-check"></i><b>2.2</b> The data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="building-your-first-mixed-model.html"><a href="building-your-first-mixed-model.html"><i class="fa fa-check"></i><b>3</b> Building your first mixed model</a><ul>
<li class="chapter" data-level="3.1" data-path="building-your-first-mixed-model.html"><a href="building-your-first-mixed-model.html#building-from-the-ground-up"><i class="fa fa-check"></i><b>3.1</b> Building from the ground up</a></li>
<li class="chapter" data-level="3.2" data-path="building-your-first-mixed-model.html"><a href="building-your-first-mixed-model.html#a-model-with-1-fixed-effect"><i class="fa fa-check"></i><b>3.2</b> A model with 1 fixed effect</a></li>
<li class="chapter" data-level="3.3" data-path="building-your-first-mixed-model.html"><a href="building-your-first-mixed-model.html#was-it-worth-it-model-comparison"><i class="fa fa-check"></i><b>3.3</b> Was it worth it? Model comparison</a></li>
<li class="chapter" data-level="3.4" data-path="building-your-first-mixed-model.html"><a href="building-your-first-mixed-model.html#random-effect-1-participant"><i class="fa fa-check"></i><b>3.4</b> Random effect #1: participant</a></li>
<li class="chapter" data-level="3.5" data-path="building-your-first-mixed-model.html"><a href="building-your-first-mixed-model.html#random-intercept-2-experiment"><i class="fa fa-check"></i><b>3.5</b> Random intercept #2: experiment</a></li>
<li class="chapter" data-level="3.6" data-path="building-your-first-mixed-model.html"><a href="building-your-first-mixed-model.html#random-intercept-3-region"><i class="fa fa-check"></i><b>3.6</b> Random intercept #3: region</a></li>
<li class="chapter" data-level="3.7" data-path="building-your-first-mixed-model.html"><a href="building-your-first-mixed-model.html#it-gets-better---random-slopes"><i class="fa fa-check"></i><b>3.7</b> It gets better - random slopes</a></li>
<li class="chapter" data-level="3.8" data-path="building-your-first-mixed-model.html"><a href="building-your-first-mixed-model.html#fixed-effects-can-be-more-complicated-too"><i class="fa fa-check"></i><b>3.8</b> Fixed effects can be more complicated too</a></li>
<li class="chapter" data-level="3.9" data-path="building-your-first-mixed-model.html"><a href="building-your-first-mixed-model.html#summary"><i class="fa fa-check"></i><b>3.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-devils-in-the-details.html"><a href="the-devils-in-the-details.html"><i class="fa fa-check"></i><b>4</b> The devil’s in the details</a><ul>
<li class="chapter" data-level="4.1" data-path="the-devils-in-the-details.html"><a href="the-devils-in-the-details.html#testing-significance"><i class="fa fa-check"></i><b>4.1</b> Testing significance</a><ul>
<li class="chapter" data-level="4.1.1" data-path="the-devils-in-the-details.html"><a href="the-devils-in-the-details.html#method-1-read-the-p-values-directly-from-model-summary"><i class="fa fa-check"></i><b>4.1.1</b> Method 1: Read the p-values directly from model summary</a></li>
<li class="chapter" data-level="4.1.2" data-path="the-devils-in-the-details.html"><a href="the-devils-in-the-details.html#method-2-model-comparison"><i class="fa fa-check"></i><b>4.1.2</b> Method 2: Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="the-devils-in-the-details.html"><a href="the-devils-in-the-details.html#contrasts"><i class="fa fa-check"></i><b>4.2</b> Contrasts</a><ul>
<li class="chapter" data-level="4.2.1" data-path="the-devils-in-the-details.html"><a href="the-devils-in-the-details.html#interpretation-reporting"><i class="fa fa-check"></i><b>4.2.1</b> Interpretation &amp; reporting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>5</b> Interactions</a></li>
<li class="chapter" data-level="6" data-path="model-not-just-md.html"><a href="model-not-just-md.html"><i class="fa fa-check"></i><b>6</b> Model (not just MD)</a></li>
<li class="chapter" data-level="7" data-path="plot.html"><a href="plot.html"><i class="fa fa-check"></i><b>7</b> Plot</a><ul>
<li class="chapter" data-level="7.1" data-path="plot.html"><a href="plot.html#interpretation"><i class="fa fa-check"></i><b>7.1</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="method-2-model-comparison-1.html"><a href="method-2-model-comparison-1.html"><i class="fa fa-check"></i><b>8</b> Method 2: Model comparison</a></li>
<li class="chapter" data-level="9" data-path="method-3-pairwise-tests.html"><a href="method-3-pairwise-tests.html"><i class="fa fa-check"></i><b>9</b> Method 3: pairwise tests</a><ul>
<li class="chapter" data-level="9.0.1" data-path="method-3-pairwise-tests.html"><a href="method-3-pairwise-tests.html#important-all-of-this-is-simple-because-these-predictors-are-orthogonal."><i class="fa fa-check"></i><b>9.0.1</b> Important: all of this is simple because these predictors are orthogonal.</a></li>
<li class="chapter" data-level="9.1" data-path="method-3-pairwise-tests.html"><a href="method-3-pairwise-tests.html#convergence-issues"><i class="fa fa-check"></i><b>9.1</b> Convergence issues</a></li>
<li class="chapter" data-level="9.2" data-path="method-3-pairwise-tests.html"><a href="method-3-pairwise-tests.html#solution-1-try-other-optimizers"><i class="fa fa-check"></i><b>9.2</b> Solution 1: try other optimizers</a><ul>
<li class="chapter" data-level="9.2.1" data-path="method-3-pairwise-tests.html"><a href="method-3-pairwise-tests.html#solution-2-brms"><i class="fa fa-check"></i><b>9.2.1</b> Solution 2: brms</a></li>
<li class="chapter" data-level="9.2.2" data-path="method-3-pairwise-tests.html"><a href="method-3-pairwise-tests.html#solution-3-reml"><i class="fa fa-check"></i><b>9.2.2</b> Solution 3: REML</a></li>
<li class="chapter" data-level="9.2.3" data-path="method-3-pairwise-tests.html"><a href="method-3-pairwise-tests.html#solution-4-simplify-your-model"><i class="fa fa-check"></i><b>9.2.3</b> Solution 4: simplify your model</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mixed Effect Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="method-3-pairwise-tests" class="section level1">
<h1><span class="header-section-number">9</span> Method 3: pairwise tests</h1>
<p>If you just want the mean estimates for each condition and you want to compare them to 0, you can use <code>ls_means()</code> from <code>lmerTest</code></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">ls_means</span>(m2)</a></code></pre></div>
<pre><code>## Least Squares Means table:
## 
##                           Estimate Std. Error   df t value    lower
## ConditionW                0.418437   0.057104 51.9  7.3277 0.303846
## ConditionS                0.539119   0.076355 54.9  7.0607 0.386096
## Systemlanguage            0.610335   0.085909 43.1  7.1045 0.437099
## SystemMD                  0.347221   0.081083 60.1  4.2823 0.185035
## ConditionW:Systemlanguage 0.427271   0.082485 41.9  5.1800 0.260793
## ConditionS:Systemlanguage 0.793398   0.112733 52.3  7.0378 0.567211
## ConditionW:SystemMD       0.409602   0.072002 56.3  5.6887 0.265382
## ConditionS:SystemMD       0.284841   0.098539 56.1  2.8906 0.087453
##                              upper  Pr(&gt;|t|)    
## ConditionW                0.533028 1.500e-09 ***
## ConditionS                0.692143 3.021e-09 ***
## Systemlanguage            0.783571 8.942e-09 ***
## SystemMD                  0.509408 6.772e-05 ***
## ConditionW:Systemlanguage 0.593750 5.970e-06 ***
## ConditionS:Systemlanguage 1.019585 4.192e-09 ***
## ConditionW:SystemMD       0.553822 4.776e-07 ***
## ConditionS:SystemMD       0.482229  0.005458 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##   Confidence level: 95%
##   Degrees of freedom method: Satterthwaite</code></pre>
<p>Potentially more useful: you can use the same function to run a bunch of pairwise comparisons. In the current model, it was reasonably easy to read the effects right off the coefficients but when there are more than 2 levels per predictor this can get trickier so tools like this can be handy.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">ls_means</span>(m2, <span class="dt">pairwise =</span> T)</a></code></pre></div>
<pre><code>## Least Squares Means table:
## 
##                                                         Estimate
## ConditionW - ConditionS                               -0.1206827
## Systemlanguage - SystemMD                              0.2631133
## ConditionW:Systemlanguage - ConditionS:Systemlanguage -0.3661265
## ConditionW:Systemlanguage - ConditionW:SystemMD        0.0176696
## ConditionW:Systemlanguage - ConditionS:SystemMD        0.1424306
## ConditionS:Systemlanguage - ConditionW:SystemMD        0.3837960
## ConditionS:Systemlanguage - ConditionS:SystemMD        0.5085570
## ConditionW:SystemMD - ConditionS:SystemMD              0.1247610
##                                                       Std. Error   df
## ConditionW - ConditionS                                0.0658722 29.0
## Systemlanguage - SystemMD                              0.1186036 54.1
## ConditionW:Systemlanguage - ConditionS:Systemlanguage  0.0974897 38.1
## ConditionW:Systemlanguage - ConditionW:SystemMD        0.1045616 46.2
## ConditionW:Systemlanguage - ConditionS:SystemMD        0.1331343 55.5
## ConditionS:Systemlanguage - ConditionW:SystemMD        0.1381564 54.5
## ConditionS:Systemlanguage - ConditionS:SystemMD        0.1466881 56.3
## ConditionW:SystemMD - ConditionS:SystemMD              0.0590843 35.0
##                                                       t value      lower
## ConditionW - ConditionS                               -1.8321 -0.2554087
## Systemlanguage - SystemMD                              2.2184  0.0253419
## ConditionW:Systemlanguage - ConditionS:Systemlanguage -3.7555 -0.5634658
## ConditionW:Systemlanguage - ConditionW:SystemMD        0.1690 -0.1927819
## ConditionW:Systemlanguage - ConditionS:SystemMD        1.0698 -0.1243195
## ConditionS:Systemlanguage - ConditionW:SystemMD        2.7780  0.1068667
## ConditionS:Systemlanguage - ConditionS:SystemMD        3.4669  0.2147419
## ConditionW:SystemMD - ConditionS:SystemMD              2.1116  0.0048193
##                                                            upper  Pr(&gt;|t|)
## ConditionW - ConditionS                                0.0140432 0.0772331
## Systemlanguage - SystemMD                              0.5008847 0.0307394
## ConditionW:Systemlanguage - ConditionS:Systemlanguage -0.1687871 0.0005774
## ConditionW:Systemlanguage - ConditionW:SystemMD        0.2281210 0.8665451
## ConditionW:Systemlanguage - ConditionS:SystemMD        0.4091806 0.2893261
## ConditionS:Systemlanguage - ConditionW:SystemMD        0.6607253 0.0074871
## ConditionS:Systemlanguage - ConditionS:SystemMD        0.8023721 0.0010151
## ConditionW:SystemMD - ConditionS:SystemMD              0.2447026 0.0419243
##                                                          
## ConditionW - ConditionS                               .  
## Systemlanguage - SystemMD                             *  
## ConditionW:Systemlanguage - ConditionS:Systemlanguage ***
## ConditionW:Systemlanguage - ConditionW:SystemMD          
## ConditionW:Systemlanguage - ConditionS:SystemMD          
## ConditionS:Systemlanguage - ConditionW:SystemMD       ** 
## ConditionS:Systemlanguage - ConditionS:SystemMD       ** 
## ConditionW:SystemMD - ConditionS:SystemMD             *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##   Confidence level: 95%
##   Degrees of freedom method: Satterthwaite</code></pre>
<p>Notice that the first 2 are the same as <code>Condition1</code> and <code>System1</code> in the effects coded model.</p>
<p>And you can also find the simple effects in there (e.g., <code>ConditionS:Systemlanguage - ConditionW:Systemlanguage</code> = <code>ConditionW</code> in the dummy coded model).</p>
<p>When models get more complicated you may need to switch to using <code>emmeans</code> which is another package with lots of great ways to probe models</p>
<div id="important-all-of-this-is-simple-because-these-predictors-are-orthogonal." class="section level3">
<h3><span class="header-section-number">9.0.1</span> Important: all of this is simple because these predictors are orthogonal.</h3>
<p>It gets more complicated if predictors are correlated. The main thing that can happen is that the estimates become unstable. In that case, it’s safer to do model comparison. You can almost always find out if an effect explains useful variance or not, but you can’t always tell what the direction or magnitude of the effect is.</p>
</div>
<div id="convergence-issues" class="section level2">
<h2><span class="header-section-number">9.1</span> Convergence issues</h2>
</div>
<div id="solution-1-try-other-optimizers" class="section level2">
<h2><span class="header-section-number">9.2</span> Solution 1: try other optimizers</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">m2.bobyqa&lt;-<span class="kw">lmer</span>(Effect_Size <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Condition<span class="op">*</span>System <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Condition<span class="op">*</span>System <span class="op">|</span>SubjectID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Condition<span class="op">*</span>System <span class="op">|</span>Experiment) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">+</span>Condition <span class="op">|</span>Region), </a>
<a class="sourceLine" id="cb46-2" data-line-number="2">                <span class="dt">data =</span> data, </a>
<a class="sourceLine" id="cb46-3" data-line-number="3">                <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>, <span class="dt">optCtrl=</span><span class="kw">list</span>(<span class="dt">maxfun=</span><span class="fl">2e5</span>)))</a></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">summary</span>(m2.bobyqa)</a></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: Effect_Size ~ 1 + Condition * System + (1 + Condition * System |  
##     SubjectID) + (1 + Condition * System | Experiment) + (1 +  
##     Condition | Region)
##    Data: data
## Control: lmerControl(optimizer = &quot;bobyqa&quot;, optCtrl = list(maxfun = 2e+05))
## 
## REML criterion at convergence: 53763
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -9.2310 -0.5470 -0.0439  0.4805  6.7886 
## 
## Random effects:
##  Groups     Name               Variance Std.Dev. Corr             
##  SubjectID  (Intercept)        0.12120  0.3481                    
##             Condition1         0.05394  0.2322   -0.21            
##             System1            0.15562  0.3945    0.05 -0.17      
##             Condition1:System1 0.12829  0.3582   -0.33  0.22  0.53
##  Experiment (Intercept)        0.02524  0.1589                    
##             Condition1         0.07536  0.2745    0.64            
##             System1            0.14960  0.3868    0.59  0.02      
##             Condition1:System1 0.11638  0.3411    0.06 -0.67  0.72
##  Region     (Intercept)        0.05612  0.2369                    
##             Condition1         0.01965  0.1402   0.42             
##  Residual                      0.28199  0.5310                    
## Number of obs: 31529, groups:  SubjectID, 679; Experiment, 30; Region, 30
## 
## Fixed effects:
##                    Estimate Std. Error       df t value Pr(&gt;|t|)    
## (Intercept)         0.47877    0.05884 52.33463   8.137 7.38e-11 ***
## Condition1          0.12066    0.06586 28.99475   1.832   0.0772 .  
## System1            -0.26312    0.11861 54.10582  -2.218   0.0307 *  
## Condition1:System1 -0.49093    0.09302 25.81664  -5.278 1.65e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) Cndtn1 Systm1
## Condition1   0.331              
## System1     -0.058 -0.044       
## Cndtn1:Sys1 -0.064 -0.492  0.480
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<p>In principle, there is a built in function, <code>allFit</code> which will run all the optimizers for you. Then you can look at their fixed effects and determine whether the estimates across all are the same (out to ~4 sig digits) or not. If they are, then it’s probably fine to use the model estimates. (Check lme4 documentation for more details)</p>
<div id="solution-2-brms" class="section level3">
<h3><span class="header-section-number">9.2.1</span> Solution 2: brms</h3>
<p><a href="https://paul-buerkner.github.io/brms/" class="uri">https://paul-buerkner.github.io/brms/</a></p>
<p>pro: highly flexible, very similar syntax</p>
<p>con: takes much longer, some new stuff to learn</p>
</div>
<div id="solution-3-reml" class="section level3">
<h3><span class="header-section-number">9.2.2</span> Solution 3: REML</h3>
<p>In all the examples above, we fit our model using maximum likelihood. The default for <code>lmer</code> is actually <a href="https://en.wikipedia.org/wiki/Restricted_maximum_likelihood">restricted maximum likelihood</a> (REML). Because it fits the data in stages, in some cases it might make it easier for the model to converge.</p>
</div>
<div id="solution-4-simplify-your-model" class="section level3">
<h3><span class="header-section-number">9.2.3</span> Solution 4: simplify your model</h3>
<p>Simplify your model iteratively, removing random effects which account for least variance first</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: Effect_Size ~ 1 + Condition * System + (1 + Condition * System |  
##     SubjectID) + (1 + Condition * System | Experiment) + (1 +  
##     Condition | Region)
##    Data: data
## 
## REML criterion at convergence: 53763
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -9.2311 -0.5470 -0.0439  0.4805  6.7886 
## 
## Random effects:
##  Groups     Name               Variance Std.Dev. Corr             
##  SubjectID  (Intercept)        0.12119  0.3481                    
##             Condition1         0.05394  0.2323   -0.21            
##             System1            0.15562  0.3945    0.05 -0.17      
##             Condition1:System1 0.12830  0.3582   -0.33  0.22  0.53
##  Experiment (Intercept)        0.02525  0.1589                    
##             Condition1         0.07541  0.2746    0.64            
##             System1            0.14975  0.3870    0.59  0.02      
##             Condition1:System1 0.11598  0.3406    0.06 -0.67  0.72
##  Region     (Intercept)        0.05608  0.2368                    
##             Condition1         0.01963  0.1401   0.42             
##  Residual                      0.28199  0.5310                    
## Number of obs: 31529, groups:  SubjectID, 679; Experiment, 30; Region, 30
## 
## Fixed effects:
##                    Estimate Std. Error       df t value Pr(&gt;|t|)    
## (Intercept)         0.47878    0.05883 52.36543   8.139 7.32e-11 ***
## Condition1          0.12068    0.06587 28.98911   1.832   0.0772 .  
## System1            -0.26311    0.11860 54.14414  -2.218   0.0307 *  
## Condition1:System1 -0.49089    0.09292 25.85691  -5.283 1.62e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) Cndtn1 Systm1
## Condition1   0.332              
## System1     -0.058 -0.044       
## Cndtn1:Sys1 -0.064 -0.491  0.480
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<p>Here that’s Condition1 slope by Region so let’s try removing that:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">m2<span class="fl">.1</span> =<span class="st"> </span><span class="kw">lmer</span>(Effect_Size <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Condition<span class="op">*</span>System <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Condition<span class="op">*</span>System<span class="op">|</span>SubjectID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Condition<span class="op">*</span>System<span class="op">|</span>Experiment) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span>Region), <span class="dt">data =</span> data)</a></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">summary</span>(m2<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: Effect_Size ~ 1 + Condition * System + (1 + Condition * System |  
##     SubjectID) + (1 + Condition * System | Experiment) + (1 |      Region)
##    Data: data
## 
## REML criterion at convergence: 54047.5
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -9.2818 -0.5467 -0.0416  0.4843  6.8475 
## 
## Random effects:
##  Groups     Name               Variance Std.Dev. Corr             
##  SubjectID  (Intercept)        0.12107  0.3480                    
##             Condition1         0.05370  0.2317   -0.21            
##             System1            0.15537  0.3942    0.05 -0.17      
##             Condition1:System1 0.12752  0.3571   -0.33  0.22  0.53
##  Experiment (Intercept)        0.02523  0.1588                    
##             Condition1         0.07526  0.2743    0.64            
##             System1            0.14987  0.3871    0.59  0.02      
##             Condition1:System1 0.11577  0.3402    0.06 -0.67  0.72
##  Region     (Intercept)        0.06549  0.2559                    
##  Residual                      0.28531  0.5341                    
## Number of obs: 31529, groups:  SubjectID, 679; Experiment, 30; Region, 30
## 
## Fixed effects:
##                    Estimate Std. Error       df t value Pr(&gt;|t|)    
## (Intercept)         0.47874    0.06174 50.88464   7.754 3.59e-10 ***
## Condition1          0.12082    0.05997 20.73487   2.015   0.0571 .  
## System1            -0.26310    0.12443 52.42237  -2.114   0.0393 *  
## Condition1:System1 -0.49092    0.07539 12.82985  -6.512 2.09e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) Cndtn1 Systm1
## Condition1   0.206              
## System1     -0.083  0.000       
## Cndtn1:Sys1 -0.001 -0.557  0.342
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<p>Okay that didn’t do it…we could keep going but it’s somewhat arbitrary and it’s hard to justify throwing out theoretically meaningful slopes</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="method-2-model-comparison-1.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
